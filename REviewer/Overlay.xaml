<Window x:Class="REviewer.Overlay"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Overlay"
        Width="300" Height="100"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        Loaded="Window_Loaded"
        Closing="Window_Closing">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Styles/DarkTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <FontFamily x:Key="PixelBoyFont">./resources/fonts/#Pixeboy</FontFamily>
        </ResourceDictionary>
    </Window.Resources>

    <Canvas x:Name="OverlayCanvas" RenderTransformOrigin="0.5,0.5">
        <!-- Enemy HP Overlay (positioned opposite to main overlay) -->
        <Border x:Name="OverlayEnemyGroup"
                Padding="8,6"
                CornerRadius="3"
                Background="#E0252526"
                BorderBrush="#505050"
                BorderThickness="1"
                RenderTransformOrigin="0,0"
                Visibility="{Binding SelectedEnemy.Visibility}">
            <Border.Effect>
                <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.4" Color="Black"/>
            </Border.Effect>
            <Border.RenderTransform>
                <ScaleTransform x:Name="OverlayEnemyGroupScale" ScaleX="1" ScaleY="1" />
            </Border.RenderTransform>
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Name="Name" Text="{Binding SelectedEnemy.Name}" 
                           Foreground="#E8E8E8" FontSize="16" FontWeight="SemiBold"
                           FontFamily="{StaticResource PixelBoyFont}" 
                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                <Border Background="#1A1A1A" CornerRadius="2" Padding="2" Margin="0,0,8,0">
                    <ProgressBar Name="HealthBar" 
                                 Value="{Binding SelectedEnemy.CurrentHealth}" 
                                 Maximum="{Binding SelectedEnemy.MaxHealth}" 
                                 Foreground="#C83232"
                                 Background="#333333"
                                 Width="140" Height="10"/>
                </Border>
                <TextBlock Name="CurrentHealth" Text="{Binding SelectedEnemy.CurrentHealth}" 
                           Foreground="#FFFFFF" FontSize="14" FontFamily="{StaticResource PixelBoyFont}"
                           VerticalAlignment="Center"/>
                <TextBlock Text="/" Foreground="#666666" FontSize="14" FontFamily="{StaticResource PixelBoyFont}"
                           VerticalAlignment="Center" Margin="3,0"/>
                <TextBlock Name="MaxHealth" Text="{Binding SelectedEnemy.MaxHealth}" 
                           Foreground="#888888" FontSize="14" FontFamily="{StaticResource PixelBoyFont}"
                           VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Main Overlay Group -->
        <Border x:Name="OverlayGroup" Padding="0" RenderTransformOrigin="0,0">
            <Border.RenderTransform>
                <ScaleTransform x:Name="MainOverlayGroupScale" ScaleX="1" ScaleY="1" />
            </Border.RenderTransform>
            <StackPanel x:Name="MainOverlayStack" Orientation="Horizontal">
                <!-- Timer/Stats Bar -->
                <Border x:Name="TweakedOverlay"
                        Background="#E0252526"
                        BorderBrush="#505050"
                        BorderThickness="1"
                        CornerRadius="3"
                        Padding="10,6"
                        Margin="0,0,4,0"
                        VerticalAlignment="Bottom">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.4" Color="Black"/>
                    </Border.Effect>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock x:Name="OverlayTimer"
                                   Text="{Binding IGTHumanFormat}"
                                   Foreground="#FFFFFF"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   FontFamily="{StaticResource PixelBoyFont}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>
                        <TextBlock x:Name="OverlayEquippedValue"
                                   Text="{Binding InventoryImagesSelected.Text}"
                                   Foreground="#4EC9B0"
                                   Visibility="{Binding InventoryImagesSelected.TextVisibility}"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   FontFamily="{StaticResource PixelBoyFont}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>
                        <TextBlock x:Name="OverlayHealth"
                                   Text="{Binding Health.Value}"
                                   Foreground="{Binding Health.Background}"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   FontFamily="{StaticResource PixelBoyFont}"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <!-- Weapon Icon -->
                <Border x:Name="WeaponIconBorder"
                        Background="#E0252526"
                        BorderBrush="#505050"
                        BorderThickness="1"
                        CornerRadius="3"
                        Padding="6"
                        VerticalAlignment="Bottom">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.4" Color="Black"/>
                    </Border.Effect>
                    <Image x:Name="WeaponIcon"
                           Source="{Binding InventoryImagesSelected.Source}" 
                           Width="50" Height="40" 
                           Opacity="{Binding InventoryImagesSelected.Opacity}"
                           RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                </Border>
            </StackPanel>
        </Border>
    </Canvas>
</Window>
